pipeline {
	agent any
	tools {
        go 'GoTool'
    	}
	environment {
        GO1175MODULE = 'on'
        CGO_ENABLED = 0 
        GOPATH = "${JENKINS_HOME}/Workspace/${WORKSPACE}/DOTT/cidr_convert_api/go"
    	}
		stages {
			stage('Build') {
				steps {
					sh '''
						rm -rf DOTT/
						git clone https://github.com/josemiguelct/DOTT.git
						go version
						cd DOTT/cidr_convert_api/go
						go get github.com/Pepegasca/goop && goop install
						goop go run api.go convert.go
						#echo "Jenkinsfile Test3"
					'''
				}
			}


			stage('Test') {
				steps {
					sh '''
						#chmod +x DOTT/cidr_convert_api/go/convert_test.go
						#./DOTT/cidr_convert_api/go/convert_test.go
						echo "Step Two"
					'''
				}
			} 

			stage('Deploy') {
				steps {
					sh '''
						echo "Step Three"
					'''
				}
			}
		}
}
